---
title: Insert title here
key: b00250667d0d70cb52717105aaa88908

---
## Feature Engineering

```yaml
type: "TitleSlide"
key: "c61f393389"
```

`@lower_third`

name: Eon Retief
title: Specialist Data Scientist, Absa Group Ltd


`@script`



---
## Preparation Material

```yaml
type: "FullSlide"
key: "af9044eee4"
center_content: false
```

`@part1`
![feature-engineering-with-pyspark.png](https://assets.datacamp.com/production/repositories/4477/datasets/7aff4265bb82379f6f2f590c6fa2688828e8e5e0/feature-engineering-with-pyspark.png)


`@script`



---
## Process of Feature Engineering

```yaml
type: "FullSlide"
key: "2074a67b34"
center_content: false
disable_transition: false
```

`@part1`
1. Imagine{{1}}
2. Create{{2}}
3. Implement{{3}}
4. Evaluate{{4}}
5. Improve{{5}}


`@script`



---
## Time-based Feature Engineering

```yaml
type: "FullCodeSlide"
key: "bef8eb8fbe"
```

`@part1`
```{python}
# Update the format of the 'date_time' to the appropriate date-time format
p_df['date_time'] = pd.to_datetime(p_df['date_time'], format = '%Y-%m-%d')
```{{1}}

```{python}
# Inspect the data types
p_df.dtypes
```{{2}}

```
...                     ...
date_time    datetime64[ns]
...                     ...
dtype: object
```{{3}}

```{python}
# Extract the day of the week from the 'date_time' column
p_df['dt_dow'] = p_df['date_time'].dt.dayofweek

# Extract the hour of the day from the 'date_time' column
p_df['dt_hod'] = p_df['date_time'].dt.hour
```{{4}}


`@script`



---
## Text-based Feature Engineering

```yaml
type: "TwoRows"
key: "5dfc75bc2b"
```

`@part1`
| user_agent |
|---|
| Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16A366  |
|  Mozilla/5.0 (Linux; Android 8.0.0; ANE-LX1 Build/HUAWEIANE-LX1; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/71.0.3578.99 Mobile Safari/537.36 |
|Mozilla/5.0 (Linux; Android 7.0; SM-G950U1 Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/65.0.3325.109 Mobile Safari/537.36 (Mobile; afma-sdk-a-v12221448.4323000.1)   |
| 	Mozilla/5.0 (iPad; CPU OS 12_1_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16C50  |


`@part2`



`@script`



---
## Text-based Feature Engineering

```yaml
type: "FullSlide"
key: "8b79afb2c1"
```

`@part1`
| user_agent                    |      | device    | os       | os_version |
|-------------------------------|------|-----------|----------|------------|
| iPhone; CPU iPhone OS 12_0    |&rarr;| iPhone    | iOS      | 12.0       |
| Linux; Android 8.0.0; ANE-LX1 |&rarr;| ANE-LX1   | Android  | 8.0.0      |
| Linux; Android 7.0; SM-G950U1 |&rarr;| SM-G950U1 | Android  | 7.0        |
| iPad; CPU OS 12_1_1           |&rarr;| iPad      | iOS      | 12.1.1     |


`@script`



---
## Group and Aggregate

```yaml
type: "TwoRows"
key: "7fb4da0897"
```

`@part1`



`@part2`



`@script`
Important to create a user-level view of the data.


---
## Let's practice!

```yaml
type: "FinalSlide"
key: "3ed571bb29"
```

`@script`


